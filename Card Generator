<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Card Generator — 360°</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f2b22;
    --card-w:360px;
    --card-h:520px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:28px;
    padding:28px;
    background: linear-gradient(180deg,#072521 0%, #0e3b2f 100%);
    font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:#e9f7f2;
  }

  /* panel */
  .panel{
    width:360px;
    background:rgba(255,255,255,0.04);
    border-radius:12px;
    padding:18px;
    box-shadow:0 8px 30px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    backdrop-filter: blur(6px);
  }
  .panel h2{
    margin:0 0 10px 0;
    font-family: "Playfair Display", serif;
    font-size:18px;
    color:#ffd9ee;
    letter-spacing:0.6px;
  }
  label{display:block;font-size:13px;margin-top:10px;color:#cbe9d9}
  input[type="text"], textarea{
    width:100%; padding:8px 10px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.06);
    background: rgba(0,0,0,0.25);
    color:#e8fff6;
    font-size:14px;
    margin-top:6px;
    outline:none;
  }
  textarea{min-height:90px; resize:vertical;}
  .btn{
    margin-top:12px;
    padding:10px 12px;
    border-radius:10px;
    cursor:pointer;
    border:none;
    font-weight:600;
    font-size:14px;
  }
  .btn-primary{background:linear-gradient(180deg,#ff84d0,#ff6bb3); color:#1a0612}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.08); color:#cfeee1}

  .stage{
    width:var(--card-w);
    perspective:1200px;
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  .card{
    width:var(--card-w);
    height:var(--card-h);
    border-radius:18px;
    position:relative;
    transform-style:preserve-3d;
    transition: transform 200ms linear;
    cursor:grab;
  }
  .card-face{
    position:absolute;
    inset:0;
    backface-visibility:hidden;
    border-radius:18px;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    background:linear-gradient(180deg,#0b2421 0%, #081a16 100%);
  }

  .frame{flex:1;padding:14px;display:flex;flex-direction:column;gap:10px}

  .title{
    height:46px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:8px;
    background:linear-gradient(180deg,#ffb0d8,#ff8ac3);
    color:#26031a;
    font-family:"Playfair Display";
    font-weight:700;
    font-size:18px;
  }

  .art{
    flex:1;border-radius:10px;margin:8px 4px;overflow:hidden;display:flex;align-items:center;justify-content:center;
  }
  .art img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:none;
  }

  .desc{
    margin:8px;
    border-radius:10px;
    padding:10px;
    font-size:13px;
    color:#f3f7f2;
    min-height:60px;
  }

  .footer{
    display:flex;justify-content:space-between;align-items:center;padding:10px 6px;
  }
  .chip{font-size:12px;padding:6px 8px;border-radius:8px;background:rgba(0,0,0,0.25)}
  .rarity{background:linear-gradient(180deg,#fbe7ff,#f1b3f0);color:#21031b;font-weight:700}
</style>
</head>
<body>

<div class="panel" id="controlsPanel">
  <h2>Card Generator</h2>

  <label>Input Name</label>
  <input id="inputName" type="text" value="The Endless Knot">

  <label>Input Description</label>
  <textarea id="inputDesc">An ancient symbol of interconnectedness...</textarea>

  <label>Upload Photo</label>
  <label class="btn btn-ghost" for="fileUpload">Choose image…</label>
  <input id="fileUpload" type="file" accept="image/*" style="display:none">
  <button id="resetImage" class="btn btn-ghost">Reset</button>

  <button id="btnGenerate" class="btn btn-primary">Generate</button>
  <button id="btnDownload" class="btn btn-ghost">Download PNG</button>
</div>

<div class="stage">
  <div class="card" id="card">
    <div class="card-face">
      <div class="frame">
        <div class="title" id="cardTitle">The Endless Knot</div>

        <div class="art">
          <img id="artImage" alt="">
        </div>

        <div class="desc" id="cardDesc">An ancient symbol...</div>

        <div class="footer">
          <div class="chip rarity">★ EPIC</div>
          <div class="chip">TYPE: ARTIFACT</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
const inputName = document.getElementById('inputName');
const inputDesc = document.getElementById('inputDesc');
const fileUpload = document.getElementById('fileUpload');
const artImage = document.getElementById('artImage');
const cardTitle = document.getElementById('cardTitle');
const cardDesc = document.getElementById('cardDesc');
const card = document.getElementById('card');

function applyGenerate(){
  cardTitle.textContent = inputName.value || 'Unnamed';
  cardDesc.textContent = inputDesc.value || '';
}
document.getElementById('btnGenerate').onclick = applyGenerate;

fileUpload.addEventListener('change', e => {
  const file = e.target.files && e.target.files[0];
  if(!file) return;
  const url = URL.createObjectURL(file);
  artImage.src = url;
  artImage.style.display = 'block';
});

document.getElementById('resetImage').onclick = () => {
  artImage.src = '';
  artImage.style.display = 'none';
};

document.getElementById('btnDownload').onclick = async () => {
  const canvas = await html2canvas(card, { scale:2, useCORS:true });
  const url = canvas.toDataURL("image/png");

  const a = document.createElement("a");
  a.href = url;
  a.download = "card.png";
  a.click();
};

/* ============================
      SAVE AS VIDEO FEATURE
   ============================*/
function recordVideo() {
  const stream = card.captureStream(30); // 30 FPS
  const recorder = new MediaRecorder(stream, { mimeType:"video/webm" });
  let chunks = [];

  recorder.ondataavailable = e => chunks.push(e.data);
  recorder.onstop = () => {
    const blob = new Blob(chunks, { type:"video/webm" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "card-rotation.webm";
    a.click();
    URL.revokeObjectURL(url);
  };

  recorder.start();

  let start = performance.now();
  function rotate(now){
    let progress = now - start;
    card.style.transform = `rotateY(${(progress/3000)*360}deg)`;

    if(progress < 3000) requestAnimationFrame(rotate);
    else recorder.stop();
  }
  requestAnimationFrame(rotate);
}

let btnVideo = document.createElement("button");
btnVideo.textContent = "Save as Video";
btnVideo.className = "btn btn-ghost";
btnVideo.onclick = recordVideo;
document.getElementById("controlsPanel").appendChild(btnVideo);

applyGenerate();
</script>

</body>
</html>
